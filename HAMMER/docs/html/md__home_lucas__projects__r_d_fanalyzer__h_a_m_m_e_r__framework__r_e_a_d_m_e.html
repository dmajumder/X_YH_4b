<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HAMMER: Framework</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">HAMMER
   &#160;<span id="projectnumber">beta</span>
   </div>
   <div id="projectbrief">High-level Analyzer for Making Measurements Efficiently with RDataFrame</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Framework </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Home to generic C++ modules.</p>
<h1>Developer Notes</h1>
<p>Adding C++ modules for use in HAMMER is relatively simple but the code makes several assumptions about the structure of the module if you'd like to use it as a #Correction.</p>
<p>A correction module should be built as a class so that the initializer can be used to book objects like files, histograms, etc that we want to load before looping over the RDataFrame. A class method should be written to perform the evaluation during the event loop. This function should be named <code>eval</code> by default. However, there is support for other function names for building multiple methods within the class.</p>
<p>The output of <code>eval</code> should be a vector organized as <code>[nominal,up,down]</code> if the function calculates a correction and uncertainty or <code>[up,down]</code> if only calculating an uncertainty. The name of the file is used to determine which type of output to expect for template building. An output of the first type should have a file name that end in <code>_SF.cc</code> or <code>_weight.cc</code> and outputs of of the second type should have a file name that ends in <code>_uncert.cc</code>.</p>
<p>Outputing a vector of vectors is not currently supported. One might want to do this if, for example, all jets in a vector need the same correction in which case a vector of <code>[nominal,up,down]</code> vectors could be calculated where the index of each <code>[nominal,up,down]</code> matches the index of the matching jet in the jet vector. While this would be useful, some development would be needed to determine how to handle the various output value with the automated correction tools.</p>
<p>The arguments to the <code>eval</code> function can be the names of the branches that you'd like to evaluate if you know these ahead of time (for example, if there are specific NanoAOD branches that are used every time). HAMMER will use clang to read the argument names defined in the function and match them to the branches available in the RDataFrame analyzed automatically so the user does not need to provide the arguments (this is useful if your function needs many arguments that are laborious to write out several times). If there are no matches to available branches, the user will have to provide the arguments (for example, if the module is very general).</p>
<p>Finally, the use of the module should be well documented for manipulation by <a href="http://www.doxygen.nl/manual/docblocks.html">Doxygen</a> so that users can easily understand the input and output in the HAMMER documentation. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
